<div class='component-gui'>
	<div class='nav has-shadow' id='topnav'>
		<div class='nav-left'>
			<div class="nav-item">
				<span class='brand'><a href="https://github.com/mermade/openapi-gui">OpenApi-GUI v3</a></span>
			</div>
		</div>
		<div class="nav-right">
			<div class='nav-item'>
				<a class="btn" v-on:click="scrollTop()"><i class='fa fa-white fa-arrow-up'></i> Top</a>
				<a class="btn" v-on:click="save()"><i class='fa fa-white fa-save'></i> Save</a>
				<a class="btn" v-on:click="undo()"><i class='fa fa-white fa-undo'></i> Undo</a>
				<a class="btn" target="_blank" href="https://twitter.com/share?source=tweetbutton&text=OpenApi-Gui%20Visual%20editor%20for%20%23OpenApi%23.0.x%20Via%20%40PermittedSoc&url=https%3A%2F%2Fgithub.com%2FMermade%2Fopenapi-gui"><i class='fa fa-white fa-twitter'></i></a>
				<a class="btn" target="_blank" href="https://twitter.com/intent/follow?screen_name=PermittedSoc"><i class='fa fa-twitter'></i> Follow</a>
				<a class='btn' target="_blank" href="https://github.com/mermade/openapi-gui"><i class='fa fa-github'></i> GitHub</a>
			</div>
		</div>
	</div>

	<div id="alert" class="modal">
		<div class="modal-background"></div>
		<div class="modal-content">
			<article class="message">
				<div class="message-body">
					<span id="alertText"></span>
				</div>
			</article>
		</div>
		<button id="alertClose" class="modal-close"></button>
	</div>

	<div id="confirm" class="modal">
		<div class="modal-background"></div>
		<div class="modal-content">
			<div class="card">
				<div class="card-content">
					<p class="title" id="confirmTitle">
					</p>
					<p class="subtitle" id="confirmSubtitle">
					</p>
				</div>
				<footer class="card-footer">
					<p class="card-footer-item">
					<a id="confirmOk"><span class="button is-primary">Confirm</span></a>
					</p>
					<p class="card-footer-item">
					<a id="confirmCancel"><span class="button is-warning">Cancel</span></a>
					</p>
				</footer>
			</div>
		</div>
		<button id="confirmClose" class="modal-close"></button>
	</div>

	<div class='container is-fluid' role='main'>
		<div class='none'>

			<a id='scrollTop'></a>
			<ul id="section-tabs" class='tabs is-boxed tab-container'>
				<li class="tabItem" id="tabItem-about">
					<a class="tabSelect" href="#about" v-on:click="selectTab('about',$event)">
						<span class="icon is-small"><i class="fa fa-info"></i></span>
						<span>About</span>
					</a>
				</li>
				<li class="tabItem" id="tabItem-input" v-on:click="selectTab('input',$event)">
					<a class="tabSelect" href='#input' id="input-tab">
						<span class="icon is-small"><i class='fa fa-upload'></i></span>
						<span>Upload</span>
					</a>
				</li>
				<li class="tabItem" id="tabItem-header">
					<a class="tabSelect" href='#header' id="header-tab" v-on:click="selectTab('header',$event)">
						<span class="icon is-small"><i class='fa fa-header'></i></span>
						<span>Header</span>
					</a>
				</li>
				<li class="tabItem" id="tabItem-servers">
					<a class="tabSelect" href='#servers' id="servers-tab" v-on:click="selectTab('servers',$event)">
						<span class="icon is-small"><i class='fa fa-server'></i></span>
						<span>Servers</span>
					</a>
				</li>
				<li class="tabItem" id="tabItem-security">
					<a class="tabSelect" href='#security' id="security-tab" v-on:click="selectTab('security',$event)">
						<span class="icon is-small"><i class='fa fa-lock'></i></span>
						<span>Security</span>
					</a>
				</li>
				<li class="tabItem" id="tabItem-tags">
					<a class="tabSelect" href='#tags' id="tags-tab" v-on:click="selectTab('tags',$event)">
						<span class="icon is-small"><i class='fa fa-tag'></i></span>
						<span>Tags</span>
					</a>
				</li>
				<li class='tabItem is-active' id="tabItem-editor">
					<a class="tabSelect" href='#editor' id="editor-tab" v-on:click="selectTab('editor',$event)">
						<span class="icon is-small"><i class='fa fa-edit'></i></span>
						<span>Edit</span>
					</a>
				</li>
				<li class="tabItem" id="tabItem-output">
					<a class="tabSelect" href='#output' id="output-tab" v-on:click="renderOutput($event)">
						<span class="icon is-small"><i class='fa fa-file'></i></span>
						<span>Export JSON</span>
					</a>
				</li>
				<li class="tabItem" id="tabItem-yaml">
					<a class="tabSelect" href='#yaml' id="yaml-tab" v-on:click="renderOutputYaml($event)">
						<span class="icon is-small"><i class='fa fa-file'></i></span>
						<span>Export YAML</span>
					</a>
				</li>
			</ul>

			<div class='tab-content'>

				<div class="tab-pane hidden container is-fluid" id="about">
					<h1 class="title">What is OpenApi-gui?</h1>
					OpenApi-gui is a GUI for creating and updating <a v-bind:href="specLink()">
					OpenApi 3.0.x</a> definitions.<br>
					<br>
					<h2 class="subtitle">How does OpenApi-gui work?</h2>
					Upload an existing definition, or create a new one (select the red 'trash-can' button to on the Upload tab to remove all Paths) and start adding
					Paths, Operations, and Parameters. When an existing definition is used, it is parsed and forms for editing each Path,
					Operation and Parameter will be created.
					<br>
					<br> By default when OpenApi-gui starts, it loads the OpenApi Petstore sample.
					<br>
					<br> Click an item from the menu on the left to begin editing. View the JSON/YAML output at any time by selecting the
					"Export" tabs. When finished, click "Download" or Copy" to copy the output to your clipboard. OpenApi-gui saves data
					only to your browser's local-storage. Data is saved before destructive edits (deletions) and when the "Save" button
					is pressed. "Undo" will return to the last-saved state. Make sure you save your JSON/YAML output when finished.
					<br>
					<br>
					<h3 class="subtitle">Converting from OpenAPI 2.0</h3>
					OpenAPI 2.0 definitions may be converted using <a href="https://openapi-converter.herokuapp.com/">this online tool</a>.
				</div>

				<div class="tab-pane hidden container is-fluid" id="input">
					<div class="columns">
						<div class="column is-2">
							<div class="container">
								<a class='button is-primary' id="load-definition" v-on:click="loadSchema()">
									<i class='fa fa-fw fa-upload'></i>Load Definition
								</a>
								<br><br>
								<a class="button is-danger remButton" v-on:click="removeAll()"><i class='fa fa-fw fa-trash'></i>Remove All</a>
							</div>
						</div>
						<div class="column is-10">
							<textarea class="textarea service-input is-fullwidth" v-model="importschema.text"></textarea>
						</div>
					</div>
				</div>

				<div class="tab-pane hidden" id="header">
					<div class="container is-fluid">
						<form class="plain-form form-horizontal" id="frmHeader">

							<div class='field is-horizontal'>
								<label class='field-label is-normal label'> Title </label>
								<div class='field-body field control'>
									<input class="input" placeholder="Required" v-model="openapi.info.title" @input="$v.openapi.info.title.$touch()" v-bind:class="{ 'is-danger': !$v.openapi.info.title.required }">
								</div>
							</div>
							<div class='field is-horizontal'>
								<label class='field-label is-normal label'> Version </label>
								<div class='field-body field control'>
									<input class="input" placeholder="Required" v-model="openapi.info.version" @input="$v.openapi.info.version.$touch()" v-bind:class="{ 'is-danger': !$v.openapi.info.version.required }">
								</div>
							</div>

							<div class="field is-horizontal">
								<div class="field-label is-normal">
									<label class="label">Description</label>
								</div>
								<div class="field-body">
									<div class="field">
										<div class="control">
											<textarea class="textarea" v-model="openapi.info.description"></textarea>
										</div>
									</div>
								</div>
							</div>

							<div class='field is-horizontal'>
								<label class='field-label is-normal label'> Contact Name </label>
								<div class='field-body field control has-icons-left'>
									<input class="input" v-model="openapi.info.contact.name">
									<span class="icon is-small is-left"><i class="fa fa-user"></i></span>
								</div>
							</div>

							<div class="field is-horizontal">
								<label class='field-label is-normal label'> Contact Email </label>
  								<span class="control field-body has-icons-left">
									<input class="input" type="email" v-model="openapi.info.contact.email">
									<span class="icon is-small is-left"><i class="fa fa-envelope"></i></span>
								</span>
							</div>

							<div class='field is-horizontal'>
								<label class='field-label is-normal label'> Contact URL </label>
								<div class='field-body field control has-icons-left'>
									<input type="url" class="input" v-model="openapi.info.contact.url">
									<span class="icon is-small is-left"><i class="fa fa-link"></i></span>
								</div>
							</div>

							<div class='field is-horizontal'>
								<label class='field-label is-normal label'> Terms of Service URL </label>
								<div class='field-body field control has-icons-left'>
									<input type="url" class="input" v-model="openapi.info.termsOfService">
									<span class="icon is-small is-left"><i class="fa fa-link"></i></span>
								</div>
							</div>
							<div class='field is-horizontal'>
								<label class='field-label is-normal label'> License Name </label>
								<div class='field-body field control'>
									<input class="input" v-model="openapi.info.license.name">
								</div>
							</div>
							<div class='field is-horizontal'>
								<label class='field-label is-normal label'> License URL </label>
								<div class='field-body field control has-icons-left'>
									<input type="url" class="input" v-model="openapi.info.license.url">
									<span class="icon is-small is-left"><i class="fa fa-link"></i></span>
								</div>
							</div>
							<div class='field is-horizontal'>
								<label class='field-label is-normal label'> External Docs </label>
								<div class='field-body field control'>
									<textarea class="textarea" v-model="openapi.externalDocs.description"></textarea>
								</div>
							</div>
							<div class='field is-horizontal'>
								<label class='field-label is-normal label'> Documentation URL </label>
								<div class='field-body field control has-icons-left'>
									<input type="url" class="input" v-model="openapi.externalDocs.url">
									<span class="icon is-small is-left"><i class="fa fa-link"></i></span>
								</div>
							</div>

						</form>
					</div>
				</div>

				<div class="tab-pane hidden" id="servers">
					<div class="container is-fluid">
						<form class="plain-form form-horizontal" id="frmServers">
							<div class="card" v-if="!openapi.servers || openapi.servers.length==0">
								<div class="card-content">
									<p class="title">
									<a v-bind:href="specLink('#serverObject')">OpenAPI Specification Servers Object</a>
									</p>
									<p class="subtitle">
										There are no servers defined. This means the API paths will be relative to the host and path
										the OpenAPI definition was loaded from.
									</p>
								</div>
								<footer class="card-footer">
									<p class="card-footer-item">
									<a v-on:click="addServer()"><span class="button is-primary"><i class="fa fa-fw fa-plus"></i>Create Server</span></a>
									</p>
								</footer>
							</div>
							<div v-for="(server,index) in openapi.servers">
								<div class="box">
									<div class="columns">
										<div class='column is-5 field level is-horizontal is-grouped'>
											<span class="icon" data-balloon="Add a server"><a v-on:click="addServer()" class='none'><i class='fa fa-plus'></i></a></span>
											<span class="icon" data-balloon="Remove server"><a v-on:click="removeServer(index)" class='none'><i class='fa fa-trash'></i></a></span>
											<label class='field-label is-normal label'>URL</label>
											<div class='field-body control has-icons-left'>
												<input class="input" placeholder="Required" v-model="server.url">
												<span class="icon is-small is-left"><i class="fa fa-link"></i></span>
											</div>
										</div>
										<div class='column is-5 field is-horizontal'>
											<label class='field-label is-normal label'> Description </label>
											<div class='field-body field control'>
												<input class="input" v-model="server.description">
											</div>
										</div>

										<div class="column field is-horizontal control">
											<a v-on:click="addVariable(index)" class="button is-primary"><i class="fa fa-fw fa-plus"></i> Add Variable</a>
											<br>
											<br>
										</div>
									</div>
									<api-srvvar v-for="(variable,index) in server.variables" :name="index" :key="index" :variable="variable" :server="server" inline-template>
										<div class="box">
											<div class="field is-horizontal is-grouped">
												<label class='field-label is-normal label'> Name </label>
												<div class="field-body field control">
													<input class="input" v-model.lazy="variableName">
												</div>
												<div class="control">
													<span class="icon" data-balloon="Remove variable"><a v-on:click="removeVariable()"><i class='fa fa-trash'></i></a></span>
												</div>
											</div>
											<div class='field is-horizontal'>
												<label class='field-label is-normal label'> Description </label>
												<div class='field-body field control'>
													<input class="input" v-model="variable.description">
												</div>
											</div>
											<div class='field is-horizontal'>
												<label class='field-label is-normal label'> Default </label>
												<div class='field-body field control'>
													<input class="input" placeholder="Required" v-model="variable.default">
												</div>
											</div>
											<div class='field is-horizontal'>
												<label class='field-label is-normal label'> Enum </label>
												<div class='field-body field control'>
													<!-- TODO -->
												</div>
											</div>
										</div>
									</api-srvvar>
								</div>
							</div>
						</form>
					</div>
				</div>

				<div class="tab-pane hidden" id="tags">
					<div class="container is-fluid box">
						<form class="columns" id="frmTags">
							<div class="column is-2 box">
								<a v-on:click="addTag()" class='button is-primary'><i class='fa fa-fw fa-plus'></i>Add Tag</a>
								<br>
								<div class="menu">
									<ul class="menu-list">
										<li v-for="(t,index) in openapi.tags"><a :href="'#tag'+index">{{t.name}}</a></li>
									</ul>
								</div>
							</div>
							<div class="column">
								<div v-for="(t,index) in openapi.tags" class="box">
									<a :name="'tag'+index"></a>
									<div class='field is-horizontal is-grouped'>
										<label class='field-label is-normal label'> Name </label>
										<div class='field-body control'>
											<input class="input" v-model="t.name">
										</div>
										<div class="control">
											<a class="icon" data-balloon="Remove tag" v-on:click="removeTag(index)"><i class='fa fa-trash'></i></a>
										</div>
									</div>
									<div class='field is-horizontal'>
										<label class='field-label is-normal label'> Description </label>
										<div class='field-body field control'>
											<textarea class="textarea" v-model="t.description"></textarea>
										</div>
									</div>
									<div class='field is-horizontal'>
										<label class='field-label is-normal label'> External Docs </label>
										<div class='field-body field control'>
											<textarea class="textarea" v-model="t.externalDocs.description"></textarea>
										</div>
									</div>
									<div class='field is-horizontal'>
										<label class='field-label is-normal label'> Docs URL </label>
										<div class='field-body field control has-icons-left'>
											<input type="url" class="input" v-model="t.externalDocs.url">
											<span class="icon is-small is-left"><i class="fa fa-link"></i></span>
										</div>
									</div>
								</div>
							</div>
						</form>
					</div>
				</div>

				<div class="tab-pane hidden" id="security">
					<div class="container is-fluid">
						<form class="columns" id="frmSecurity">
							<div class="column is-2 box">
								<a class="button is-primary" v-on:click="addSecurityDefinition()"><i class='fa fa-plus'></i>&nbsp;Add Security Scheme</a>
								<br>
								<div class="menu">
									<ul class="menu-list">
										<li v-for="(sd, sdname) in openapi.components.securitySchemes">
											<a :href="'#sec'+sdname">{{sdname}}</a>
											<ul>
												<li v-for="(flow,flowName) in sd.flow">{{flowName}}
													<ul>
														<li v-for="(sdesc, sname) in flow.scopes">{{sname}}</li>
													</ul>
												</li>
											</ul>
										</li>
									</ul>
								</div>
							</div>
							<div class="column is-10">
							<api-secdef v-for="(sd, sdname) in openapi.components.securitySchemes"
								:key="sdname" :sd='sd' :sdname='sdname' :openapi='openapi' inline-template>
								<div class="container is-fluid box">
									<a :name="'sec'+sdname"></a>
									<div class="field is-grouped">
										<div class="control">
											<label class="field-label is-normal label">&nbsp;</label>
											<a class="icon" data-balloon="Add securityScheme" v-on:click="addSecurityDefinition()"><i class='fa fa-plus'></i></a>
										</div>
										<div class="control">
											<label class="field-label is-normal label">&nbsp;</label>
											<a class="icon" data-balloon="Remove securityScheme" v-on:click="removeSecurityDefinition(sdname)"><i class='fa fa-trash'></i></a>
										</div>
										<div class="control is-expanded">
											<label class='field-label is-normal label'> Name </label>
											<div class='field-body'>
												<input class="input" v-model.lazy="secname">
											</div>
										</div>
										<!--<div class="control">
											<label class="field-label is-normal label">&nbsp;</label>
											<div class="field-body">
												<a v-on:click="removeSecurityDefinition(sdname)" class='button is-danger'><i class='fa fa-fw fa-trash'></i>Delete</a>
											</div>
										</div>-->
										<div class='control'>
											<label class='field-label is-normal label' for="selSdType"> Type </label>
											<div class='field-body'>
												<div class="select">
													<select name="selSdType" v-model="type">
														<option value="apiKey">API Key</option>
														<option value="oauth2">oAuth2</option>
														<option value="http">HTTP Authentication</option>
													</select>
												</div>
											</div>
										</div>
										<div class='control'>
											<label class='field-label is-normal label'> Apply&nbsp;to&nbsp;all&nbsp;paths </label>
											<div class='field-body field control'>
												<input type='checkbox' :value='sdname' v-model='appliesToAllPaths'>
											</div>
										</div>
									</div>

									<div v-if="sd.type == 'apiKey'" class='animate-if'>
										<div class='field is-horizontal'>
											<label class='field-label is-normal label'> Parameter Name </label>
											<div class='field-body field control'>
												<input class="input" v-model="sd.name">
											</div>
										</div>
										<div class='field is-horizontal'>
											<label class='field-label is-normal label'> Location </label>
											<div class='field-body field control'>
												<div class="select">
													<select class="selectx" name="selLocation" v-model="sd.in">
														<option value="header">Header</option>
														<option value="query">Query</option>
													</select>
												</div>
											</div>
										</div>
									</div>
									<div v-if="sd.type == 'oauth2'" class='animate-if'>
										<div class="field control level box">
											<div class="level-left">
												<div class="level-item field is-horizontal">
													<label class="field-label is-normal label">Flows:</label>
													<div class='field-body field control'>&nbsp;</div>
												</div>
												<div class='level-item field is-horizontal'>
													<label class='field-label is-normal label'>Implicit</label>
													<div class='field-body field control'>
														<input type='checkbox' class="checkbox" v-model='hasImplicit'>
													</div>
												</div>
												<div class='level-item field is-horizontal'>
													<label class='field-label is-normal label'>Password</label>
													<div class='field-body field control'>
														<input type='checkbox' class="checkbox" v-model='hasPassword'>
													</div>
												</div>
												<div class='level-item field is-horizontal'>
													<label class='field-label is-normal label'>clientCredentials</label>
													<div class='field-body field control'>
														<input type='checkbox' class="checkbox" v-model='hasClientCred'>
													</div>
												</div>
												<div class='level-item field is-horizontal'>
													<label class='field-label is-normal label'>authorizationCode</label>
													<div class='field-body field control'>
														<input type='checkbox' class="checkbox" v-model='hasAuthCode'>
													</div>
												</div>
												<div class="level-item"></div> <!-- last level-item is wrongly positioned -->
											</div>
										</div>

										<div class="box" v-for="(flow,flowName) in sd.flow">
											<div class='field is-horizontal'>
												<label class='field-label is-normal label'> Flow: {{ flowName }} </label>
											</div>

											<div class='field is-horizontal'>
												<label class='field-label is-normal label'> Authorization URL </label>
												<div class='field-body field control has-icons-left'>
													<input type="url" class="input" v-model="flow.authorizationUrl">
													<span class="icon is-small is-left"><i class="fa fa-link"></i></span>
												</div>
											</div>
											<div class='field is-horizontal'>
												<label class='field-label is-normal label'> Token URL </label>
												<div class='field-body field control has-icons-left'>
													<input type="url" class="input" v-model="flow.tokenUrl">
													<span class="icon is-small is-left"><i class="fa fa-link"></i></span>
												</div>
											</div>
											<div class='field is-horizontal'>
												<label class='field-label is-normal label'> Refresh URL </label>
												<div class='field-body field control has-icons-left'>
													<input type="url" class="input" v-model="flow.refreshUrl">
													<span class="icon is-small is-left"><i class="fa fa-link"></i></span>
												</div>
											</div>
											<div class='box'>
												<div class="card" v-if="Object.keys(flow.scopes).length==0">
													<div class="card-content">
														<p class="title">
														<a v-bind:href="specLink('#scopesObject')">OpenAPI Specification Scopes Object</a>
														</p>
														<p class="subtitle">
															There are no scopes defined yet for this oAuth2 flow.
														</p>
													</div>
													<footer class="card-footer">
														<p class="card-footer-item">
														<a v-on:click="addScope(flow)"><span class="button is-primary"><i class="fa fa-fw fa-plus"></i>Create Scope</span></a>
														</p>
													</footer>
												</div>

												<api-scope v-for="(sdesc, sname) in flow.scopes" :sd="sd" :sdname="sdname" :sname="sname" :key="sname" :flow="flow" inline-template>
													<div class="box">
														<div class='field is-horizontal level is-grouped'>
															<div class="control">
																<a class="icon" data-balloon="Add scope" v-on:click="addScope(flow)"><i class='fa fa-plus'></i></a>
															</div>
															<div class="control">
																<a class="icon" data-balloon="Duplicate scope" v-on:click="duplicateScope(flow)"><i class='fa fa-copy'></i></a>
															</div>
															<div class="control">
																<a class="icon" data-balloon="Remove scope" v-on:click="removeScope(flow,sname)"><i class='fa fa-trash'></i></a>
															</div>
															<label class='field-label is-normal label'> Scope Name </label>
															<div class='field-body field control'>
																<input class="input" v-model.lazy="scopename">
															</div>
														</div>
														<div class='field is-horizontal'>
															<label class='field-label is-normal label'> Description </label>
															<div class='field-body field control'>
																<input class="input" v-model="flow.scopes[sname]">
															</div>
														</div>
													</div>
												</api-scope>
											</div>

										</div>

									</div>
								</div>
							</api-secdef>
							</div>
						</form>
					</div>
				</div>

				<div class="tab-pane hidden" id="output">
					<api-definition></api-definition>
				</div>

				<div class="tab-pane hidden" id="yaml">
					<api-yaml></api-yaml>
				</div>

				<div class='tab-pane is-active' id='editor'>

					<div class='container is-fluid columns'>
						<div class='column is-2 box'>
							<aside id="drop-container" class="menu menu-small">
								<ul id="resourceList" class="menu-list" role="menu" aria-labelledby="dropdownMenu">
									<li class='dropdown-submenu' v-for="(path,key) in openapi.paths">
										<a :href="path.id" target="_self" v-on:click="showResource(key)">{{key}}</a>
										<ul class='dropdown-menu'>
											<li v-for="(m,mkey) in path">
												<template v-if="'.get.post.put.patch.head.options.delete.trace'.indexOf(mkey)>0">
													<a :href="m.id" target="_self" v-on:click="showResource(key)">{{mkey}}</a>
												</template>
											</li>
										</ul>
									</li>
								</ul>
							</aside>
						</div>

						<div class="column box">
							<form class="form-horizontal" id="config">
								<div class="card" v-if="Object.keys(openapi.paths).length==0">
									<div class="card-content">
										<p class="title">
										<a v-bind:href="specLink('#pathsObject')">OpenAPI Specification Paths Object</a>
										</p>
										<p class="subtitle">
											There are no paths defined yet for this definition.
										</p>
									</div>
									<footer class="card-footer">
										<p class="card-footer-item">
										<a v-on:click="addResource()"><span class="button is-primary"><i class="fa fa-fw fa-plus"></i>Create Path</span></a>
										</p>
									</footer>
								</div>
								<div class="resource" v-for="(path,key,index) in openapi.paths">
									<api-resource :openapi='openapi' :path='path' :index='key' :maintags='openapi.tags'></api-resource>
								</div>
							</form>
						</div>

					</div>
				</div>
			</div>
		</div>
	</div>
</div>
